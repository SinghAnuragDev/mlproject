option_settings:
  aws:elasticbeanstalk:application:environment:
    PYTHONPATH: "/var/app/current:$PYTHONPATH"
  aws:elasticbeanstalk:container:python:
    WSGIPath: application:application

# --- COMMANDS TO INSTALL SYSTEM TOOLS AND HEAVY LIBS FIRST ---
# This ensures the compiler (gcc/g++) is installed BEFORE pip runs.
commands:
  01_install_compiler_tools:
    command: "sudo yum install -y gcc gcc-c++ python3-devel"
    
  02_install_heavy_dependencies:
    # This installs XGBoost and CatBoost (the crashing packages) in a dedicated step.
    command: "pip install xgboost catboost" 

# --- CONFIGURATION TO INSTALL REMAINING DEPENDENCIES ---
# This tells AWS to ignore the heavy packages in the main requirements.txt 
# since we installed them manually above, preventing a second crash attempt.
container_commands:
  03_main_install:
    command: "pip install -r requirements.txt --ignore-installed xgboost catboost"