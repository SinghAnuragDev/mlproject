option_settings:
  aws:elasticbeanstalk:application:environment:
    PYTHONPATH: "/var/app/current:$PYTHONPATH"
  aws:elasticbeanstalk:container:python:
    WSGIPath: application:application

# --- COMMANDS TO INSTALL SYSTEM TOOLS AND HEAVY LIBS FIRST ---
# These commands run BEFORE the main pip install
commands:
  01_install_compiler_tools:
    command: "sudo yum install -y gcc gcc-c++ python3-devel"
    
  02_install_heavy_dependencies:
    # This installs XGBoost and CatBoost and their dependencies first.
    command: "pip install xgboost catboost" 

# --- CONFIGURATION TO USE THE INSTALLED DEPENDENCIES ---
# This tells AWS to ignore the heavy packages in the main requirements.txt 
# since we installed them manually above.
container_commands:
  03_main_install:
    command: "pip install -r requirements.txt --ignore-installed xgboost catboost"